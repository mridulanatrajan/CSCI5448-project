package chatapp;

import javax.swing.JFrame;
import javax.swing.JScrollPane;
import javax.swing.JTextArea;
import javax.swing.JTextField;
import javax.swing.JButton;
import java.awt.event.ActionListener;
import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;
import java.io.PrintWriter;
import java.net.Socket;
import java.net.UnknownHostException;
import java.awt.event.ActionEvent;

public class GroupClient implements ChatObserver{

	 BufferedReader in;
	    PrintWriter out;
	    JFrame frame = new JFrame("Chatter");
	    JTextField textField = new JTextField();
	    JTextArea messageArea = new JTextArea();
		JButton btnNewButton = new JButton("Send");
	
    public GroupClient(){
    	
    	frame.setBounds(100, 100, 444, 309);
		textField.setBounds(12, 201, 296, 50);
        messageArea.setBounds(12, 12, 425, 163);
        btnNewButton.addActionListener(new ActionListener() {
        	public void actionPerformed(ActionEvent e) {
        	
        		out.println(textField.getText());
                textField.setText("");
        	}
        });
        btnNewButton.setBounds(320, 201, 117, 38);
        frame.getContentPane().setLayout(null);
        frame.getContentPane().add(textField);
        frame.getContentPane().add(messageArea);
        frame.getContentPane().add(btnNewButton);
		
        textField.addActionListener(new ActionListener() {
          
            public void actionPerformed(ActionEvent e) {
                out.println(textField.getText());
                textField.setText("");
            }
        });
        frame.setVisible(true);
    }
    
    public void update(String msg)
    {
    	messageArea.append(msg.substring(4)+"\n");
    }

    public void run() throws IOException {

        Socket socket = new Socket("127.0.0.1", 1991);
        in = new BufferedReader(new InputStreamReader(
            socket.getInputStream()));
        out = new PrintWriter(socket.getOutputStream(), true);

        while (true) {
            String line = in.readLine();
            if(line.startsWith("mode"))
            {
            	out.println("group");
            }
            else if (line.startsWith("name")) {
                out.println(User.getUsername());
            }
            else if (line.startsWith("group"))
            {
            	out.println(Group.getGroupname());
            }
            else if (line.startsWith("msg ")) {
            	update(line);
                //messageArea.append(line.substring(4) + "\n");
            }
        }

		
	}
}
